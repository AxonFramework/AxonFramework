/*
 * Copyright (c) 2010-2025. Axon Framework
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.axonframework.updates.api;

import java.util.Objects;

/**
 * Represents a vulnerability in an AxonIQ Artifact in use. This object contains information about the artifact's group
 * ID, artifact ID, severity of the vulnerability, the recommended fix version, and a description of the vulnerability.
 *
 * @author Mitchell Herrijgers
 * @since 4.12.0
 */
public class DetectedVulnerability {

    private final String groupId;
    private final String artifactId;
    private final DetectedVulnerabilitySeverity severity;
    private final String fixVersion;
    private final String description;

    /**
     * Constructs a {@code DetectedVulnerability} with the given {@code groupId}, {@code artifactId}, {@code severity},
     * {@code fixVersion}, and {@code description}.
     *
     * @param groupId     The group ID of the artifact.
     * @param artifactId  The artifact ID of the artifact.
     * @param severity    The severity of the vulnerability, represented by the {@link DetectedVulnerabilitySeverity}
     *                    enum.
     * @param fixVersion  The recommended version to fix the vulnerability.
     * @param description A description of the vulnerability, providing details about its nature and impact.
     */
    public DetectedVulnerability(String groupId,
                                 String artifactId,
                                 DetectedVulnerabilitySeverity severity,
                                 String fixVersion,
                                 String description) {
        this.groupId = groupId;
        this.artifactId = artifactId;
        this.severity = severity;
        this.fixVersion = fixVersion;
        this.description = description;
    }

    /**
     * Returns the group identifier of this detected vulnerability.
     *
     * @return The group identifier of this detected vulnerability.
     */
    public String groupId() {
        return groupId;
    }

    /**
     * Returns the artifact identifier of this detected vulnerability.
     *
     * @return The artifact identifier of this detected vulnerability.
     */
    public String artifactId() {
        return artifactId;
    }

    /**
     * Returns the severity of this detected vulnerability.
     *
     * @return The severity of this detected vulnerability.
     */
    public DetectedVulnerabilitySeverity severity() {
        return severity;
    }

    /**
     * Returns the fix version of this detected vulnerability.
     *
     * @return The fix version of this detected vulnerability.
     */
    public String fixVersion() {
        return fixVersion;
    }

    /**
     * Returns the description of this detected vulnerability.
     *
     * @return The description of this detected vulnerability.
     */
    public String description() {
        return description;
    }

    @Override
    public boolean equals(Object o) {
        if (o == null || getClass() != o.getClass()) {
            return false;
        }
        DetectedVulnerability that = (DetectedVulnerability) o;
        return Objects.equals(groupId, that.groupId)
                && Objects.equals(artifactId, that.artifactId)
                && severity == that.severity
                && Objects.equals(fixVersion, that.fixVersion)
                && Objects.equals(description, that.description);
    }

    @Override
    public int hashCode() {
        return Objects.hash(groupId, artifactId, severity, fixVersion, description);
    }

    @Override
    public String toString() {
        return "DetectedVulnerability{" +
                "groupId='" + groupId + '\'' +
                ", artifactId='" + artifactId + '\'' +
                ", severity=" + severity +
                ", fixVersion='" + fixVersion + '\'' +
                ", description='" + description + '\'' +
                '}';
    }
}
